image:
  repository: postgres
  tag: 15

nameOverride: "db"
fullnameOverride: "db"

service:
  port: 5432

initContainers:
  - name: liquibase
    image: ghcr.io/moleus/highload-systems-itmo/db-init:pavel-setup-k8s
    command:
      - liquibase
      - --changeLogFile=changelog/changelog-root.yaml
      - --url=jdbc:postgresql://db:5432/$POSTGRES_DB
      - --username=$POSTGRES_USER
      - --password=$POSTGRES_PASSWORD
      - --log-level=debug
      - update

envs:
  - name: POSTGRES_DB
    value: postgres
  - name: POSTGRES_USER
    valueFrom:
      secretKeyRef:
        name: db-secrets
        key: username
  - name: POSTGRES_PASSWORD
    valueFrom:
      secretKeyRef:
        name: db-secrets
        key: password
